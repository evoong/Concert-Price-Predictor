{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "505e2c9e",
   "metadata": {},
   "source": [
    "# Taylor Swift Artist Functions Test\n",
    "Testing all artist profile functions from socials_tracker.ipynb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "aaadc85f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\ud83d\udce6 Libraries loaded (v4.0 Foundation).\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n",
      "  from .autonotebook import tqdm as notebook_tqdm\n",
      "/var/folders/9h/ghtl82dn5bvgn2ck1qdxgf9m0000gp/T/ipykernel_27275/2180024096.py:18: FutureWarning: \n",
      "\n",
      "All support for the `google.generativeai` package has ended. It will no longer be receiving \n",
      "updates or bug fixes. Please switch to the `google.genai` package as soon as possible.\n",
      "See README for more details:\n",
      "\n",
      "https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md\n",
      "\n",
      "  import google.generativeai as genai\n"
     ]
    }
   ],
   "source": [
    "# Import required libraries\n",
    "import os\n",
    "import re\n",
    "import json\n",
    "import time\n",
    "import requests\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import scrapers\n",
    "from scrapers import InstagramProfile, TwitterProfile, SpotifyProfile, StubhubProfile\n",
    "try:\n",
    "    import google.generativeai as genai\n",
    "    HAS_GEMINI = True\n",
    "except ImportError:\n",
    "    HAS_GEMINI = False\n",
    "\n",
    "print(\"\ud83d\udce6 Libraries loaded (v4.0 Modular).\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "9e42484a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Initialize Selenium WebDriver\n",
    "options = webdriver.ChromeOptions()\n",
    "# options.add_argument('--headless')  # Uncomment to run in headless mode\n",
    "driver = webdriver.Chrome(options=options)"
   ]
  },
  {
   "cell_type": "code",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Initialize modular scrapers with ready globals\n",
    "scrapers.set_globals(driver, model, headers if 'headers' in globals() else {})\n",
    "print('\ud83d\udfe2 Scraper globals initialized.')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "spotify_creds",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Spotify API credentials loaded successfully!\n"
     ]
    }
   ],
   "source": [
    "# Spotify API credentials (optional - web scraping will work without them)\n",
    "headers = None\n",
    "access_token = None\n",
    "\n",
    "try:\n",
    "    # Try current directory first, then parent\n",
    "    creds_path = \"spotify_credentials.json\"\n",
    "    try:\n",
    "        with open(creds_path, \"r\") as f:\n",
    "            credentials = json.load(f)\n",
    "    except FileNotFoundError:\n",
    "        creds_path = \"../spotify_credentials.json\"\n",
    "        with open(creds_path, \"r\") as f:\n",
    "            credentials = json.load(f)\n",
    "\n",
    "    client_id = credentials[\"client_id\"]\n",
    "    client_secret = credentials[\"client_secret\"]\n",
    "    auth_url = credentials[\"auth_url\"]\n",
    "    \n",
    "    response = requests.post(\n",
    "        auth_url,\n",
    "        headers={\"Content-Type\": \"application/x-www-form-urlencoded\"},\n",
    "        data={\n",
    "            \"grant_type\": \"client_credentials\",\n",
    "            \"client_id\": client_id,\n",
    "            \"client_secret\": client_secret\n",
    "        }\n",
    "    )\n",
    "\n",
    "    if response.status_code == 200:\n",
    "        token_info = response.json()\n",
    "        access_token = token_info['access_token']\n",
    "        headers = {\"Authorization\": f\"Bearer {access_token}\"}\n",
    "        print(\"Spotify API credentials loaded successfully!\")\n",
    "    else:\n",
    "        print(\"Failed to retrieve access token, will use web scraping only\")\n",
    "except Exception as e:\n",
    "    print(f\"No Spotify credentials found or error loading them: {e} - will use web scraping only\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "class_definitions",
   "metadata": {},
   "source": [
    "## Profile Class Definitions (v4.0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "test_section",
   "metadata": {},
   "source": [
    "## Test Execution"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "run_full_test",
   "metadata": {},
   "outputs": [],
   "source": [
    "def run_full_test(artist_name, ig_user=None, tw_user=None, spot_id=None, stub_url=None):\n",
    "    print(f\"\\n{'='*50}\")\n",
    "    print(f\"\ud83d\ude80 TESTING: {artist_name}\")\n",
    "    print(f\"{'='*50}\\n\")\n",
    "    \n",
    "    # 1. Instagram\n",
    "    ig = InstagramProfile(artist_name, username=ig_user)\n",
    "    ig.get_all()\n",
    "    print(f\"\\n\ud83d\udcf8 Instagram Result: {ig.username} | {ig.follower_count:,} followers\")\n",
    "    \n",
    "    # 2. Twitter\n",
    "    tw = TwitterProfile(artist_name, username=tw_user)\n",
    "    tw.get_all()\n",
    "    print(f\"\\n\ud83d\udc26 Twitter Result: {tw.username} | {tw.follower_count:,} followers\")\n",
    "    \n",
    "    # 3. Spotify\n",
    "    sp = SpotifyProfile(artist_name, spotifyID=spot_id)\n",
    "    sp.get_all()\n",
    "    print(f\"\\n\ud83c\udfa7 Spotify Result: {sp.spotifyID} | {sp.followers:,} followers | Listeners: {sp.listens:,} | Popularity: {sp.popularity} | Genre: {sp.genre}\")\n",
    "    \n",
    "    # 4. Stubhub\n",
    "    sh = StubhubProfile(artist_name, url=stub_url)\n",
    "    sh.get_all()\n",
    "    print(f\"\\n\ud83c\udf9f\ufe0f Stubhub Result: {sh.url} | {sh.favourites:,} favourites\")\n",
    "    \n",
    "    return ig, tw, sp, sh"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "execute_test",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "==================================================\n",
      "\ud83d\ude80 TESTING: Taylor Swift\n",
      "==================================================\n",
      "\n",
      "\n",
      "\ud83d\udcf8 Instagram Result: taylorswift | 280,942,001 followers\n",
      "\n",
      "\ud83d\udc26 Twitter Result: taylorswift13 | 78,800,000 followers\n",
      "\n",
      "\ud83c\udfa7 Spotify Result: 06HL4z0CvFAxyc27GXpf02 | 150,801,542 followers | Listeners: 105,900,000 | Popularity: 100 | Genre: Pop\n",
      "\n",
      "\ud83c\udf9f\ufe0f Stubhub Result: https://www.stubhub.com/taylor-swift-tickets/performer/136034 | 62,300 favourites\n",
      "\n",
      "Expected values (as of Jan 2026):\n",
      "  Instagram: ~281M followers\n",
      "  Twitter: ~75M followers\n",
      "  Spotify: ~106M monthly listeners, ~150M followers\n",
      "  Stubhub: ~62K favourites\n"
     ]
    }
   ],
   "source": [
    "# Execute Test for Taylor Swift\n",
    "instagram, twitter, spotify, stubhub = run_full_test(\n",
    "    \"Taylor Swift\", \n",
    "    ig_user=\"taylorswift\", \n",
    "    tw_user=\"taylorswift13\", \n",
    "    spot_id=\"06HL4z0CvFAxyc27GXpf02\",\n",
    "    stub_url=\"https://www.stubhub.com/taylor-swift-tickets/performer/136034\"\n",
    ")\n",
    "\n",
    "print(f\"\\nExpected values (as of Jan 2026):\")\n",
    "print(f\"  Instagram: ~281M followers\")\n",
    "print(f\"  Twitter: ~75M followers\")\n",
    "print(f\"  Spotify: ~106M monthly listeners, ~150M followers\")\n",
    "print(f\"  Stubhub: ~62K favourites\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "summary_section",
   "metadata": {},
   "source": [
    "## Summary - All Profiles for Taylor Swift"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "summary_output",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "==================================================\n",
      "TAYLOR SWIFT - SOCIAL MEDIA SUMMARY\n",
      "==================================================\n",
      "\n",
      "INSTAGRAM:\n",
      "Artist: Taylor Swift\n",
      "Instagram Username: taylorswift\n",
      "Followers: 280,942,001\n",
      "\n",
      "TWITTER/X:\n",
      "Artist: Taylor Swift\n",
      "Twitter Username: taylorswift13\n",
      "Followers: 78,800,000\n",
      "\n",
      "SPOTIFY:\n",
      "Artist: Taylor Swift\n",
      "Spotify ID: 06HL4z0CvFAxyc27GXpf02\n",
      "Genre: Pop\n",
      "Followers: 150,801,542\n",
      "Popularity: 100\n",
      "Monthly Listeners: 105,900,000\n",
      "\n",
      "STUBHUB:\n",
      "Artist: Taylor Swift\n",
      "Stubhub URL: https://www.stubhub.com/taylor-swift-tickets/performer/136034\n",
      "Favourites: 62,300\n",
      "\n",
      "==================================================\n"
     ]
    }
   ],
   "source": [
    "# Summary of all Taylor Swift social media data\n",
    "print(\"=\"*50)\n",
    "print(\"TAYLOR SWIFT - SOCIAL MEDIA SUMMARY\")\n",
    "print(\"=\"*50)\n",
    "print()\n",
    "print(\"INSTAGRAM:\")\n",
    "print(instagram)\n",
    "print()\n",
    "print(\"TWITTER/X:\")\n",
    "print(twitter)\n",
    "print()\n",
    "print(\"SPOTIFY:\")\n",
    "print(spotify)\n",
    "print()\n",
    "print(\"STUBHUB:\")\n",
    "print(stubhub)\n",
    "print()\n",
    "print(\"=\"*50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "cleanup",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Browser closed.\n"
     ]
    }
   ],
   "source": [
    "# Clean up - close the browser\n",
    "driver.quit()\n",
    "print(\"Browser closed.\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}